{"version":3,"file":"index-es.min.js","sources":["../src/index.js"],"sourcesContent":["export default function loadStylesheets (stylesheets, {\n    before: beforeDefault, after: afterDefault, favicon: faviconDefault,\n    canvas: canvasDefault, image: imageDefault = true,\n    acceptErrors\n} = {}) {\n    stylesheets = Array.isArray(stylesheets) ? stylesheets : [stylesheets];\n\n    function setupLink (stylesheetURL) {\n        let options = {};\n        if (Array.isArray(stylesheetURL)) {\n            ([stylesheetURL, options = {}] = stylesheetURL);\n        }\n        let {favicon = faviconDefault} = options;\n        const {\n            before = beforeDefault,\n            after = afterDefault,\n            canvas = canvasDefault,\n            image = imageDefault\n        } = options;\n        function addLink () {\n            if (before) {\n                before.before(link);\n            } else if (after) {\n                after.after(link);\n            } else {\n                // eslint-disable-next-line unicorn/prefer-node-append\n                document.head.appendChild(link);\n            }\n        }\n\n        const link = document.createElement('link');\n\n        // eslint-disable-next-line promise/avoid-new\n        return new Promise((resolve, reject) => {\n            let rej = reject;\n            if (acceptErrors) {\n                rej = typeof acceptErrors === 'function'\n                    ? (error) => {\n                        acceptErrors({\n                            error, stylesheetURL, options, resolve, reject\n                        });\n                    }\n                    : resolve;\n            }\n            if (stylesheetURL.endsWith('.css')) {\n                favicon = false;\n            } else if (stylesheetURL.endsWith('.ico')) {\n                favicon = true;\n            }\n            if (favicon) {\n                link.rel = 'shortcut icon';\n                link.type = 'image/x-icon';\n\n                if (image === false) {\n                    link.href = stylesheetURL;\n                    addLink();\n                    resolve(link);\n                    return;\n                }\n\n                const cnv = document.createElement('canvas');\n                cnv.width = 16;\n                cnv.height = 16;\n                const context = cnv.getContext('2d');\n                const img = document.createElement('img');\n                img.addEventListener('error', (error) => {\n                    reject(error);\n                });\n                img.addEventListener('load', () => {\n                    context.drawImage(img, 0, 0);\n                    link.href = canvas\n                        ? cnv.toDataURL('image/x-icon')\n                        : stylesheetURL;\n                    addLink();\n                    resolve(link);\n                });\n                img.src = stylesheetURL;\n                return;\n            }\n            link.rel = 'stylesheet';\n            link.type = 'text/css';\n            link.href = stylesheetURL;\n            addLink();\n            link.addEventListener('error', (error) => {\n                rej(error);\n            });\n            link.addEventListener('load', () => {\n                resolve(link);\n            });\n        });\n    }\n\n    return Promise.all(\n        stylesheets.map((stylesheetURL) => setupLink(stylesheetURL))\n    );\n}\n"],"names":["stylesheets","beforeDefault","before","afterDefault","after","faviconDefault","favicon","canvasDefault","canvas","image","imageDefault","acceptErrors","Array","isArray","Promise","all","map","stylesheetURL","options","addLink","link","document","head","appendChild","createElement","resolve","reject","rej","error","endsWith","rel","type","href","cnv","width","height","context","getContext","img","addEventListener","drawImage","toDataURL","src","setupLink"],"mappings":"qgBAAe,SAA0BA,gEAIrC,GAHQC,IAARC,OAA8BC,IAAPC,MAA8BC,IAATC,QACpCC,IAARC,WAAuBC,MAAOC,gBAC9BC,IAAAA,oBAEAX,EAAcY,MAAMC,QAAQb,GAAeA,EAAc,CAACA,GAuFnDc,QAAQC,IACXf,EAAYgB,KAAI,SAACC,mBAtFDA,OACZC,EAAU,MACVN,MAAMC,QAAQI,GAAgB,SACGA,KAA/BA,kBAAeC,aAAU,WAEEA,EAA5BZ,QAAAA,aAAUD,MAMXa,MAJAhB,OAAAA,aAASD,QACTG,MAAAA,aAAQD,QACRK,OAAAA,aAASD,QACTE,MAAAA,aAAQC,aAEHS,IACDjB,EACAA,EAAOA,OAAOkB,GACPhB,EACPA,EAAMA,MAAMgB,GAGZC,SAASC,KAAKC,YAAYH,OAI5BA,EAAOC,SAASG,cAAc,eAG7B,IAAIV,SAAQ,SAACW,EAASC,OACrBC,EAAMD,KACNf,IACAgB,EAA8B,mBAAjBhB,EACP,SAACiB,GACCjB,EAAa,CACTiB,MAAAA,EAAOX,cAAAA,EAAeC,QAAAA,EAASO,QAAAA,EAASC,OAAAA,KAG9CD,GAENR,EAAcY,SAAS,QACvBvB,GAAU,EACHW,EAAcY,SAAS,UAC9BvB,GAAU,GAEVA,EAAS,IACTc,EAAKU,IAAM,gBACXV,EAAKW,KAAO,gBAEE,IAAVtB,SACAW,EAAKY,KAAOf,EACZE,SACAM,EAAQL,OAINa,EAAMZ,SAASG,cAAc,UACnCS,EAAIC,MAAQ,GACZD,EAAIE,OAAS,OACPC,EAAUH,EAAII,WAAW,MACzBC,EAAMjB,SAASG,cAAc,cACnCc,EAAIC,iBAAiB,SAAS,SAACX,GAC3BF,EAAOE,MAEXU,EAAIC,iBAAiB,QAAQ,WACzBH,EAAQI,UAAUF,EAAK,EAAG,GAC1BlB,EAAKY,KAAOxB,EACNyB,EAAIQ,UAAU,gBACdxB,EACNE,IACAM,EAAQL,WAEZkB,EAAII,IAAMzB,GAGdG,EAAKU,IAAM,aACXV,EAAKW,KAAO,WACZX,EAAKY,KAAOf,EACZE,IACAC,EAAKmB,iBAAiB,SAAS,SAACX,GAC5BD,EAAIC,MAERR,EAAKmB,iBAAiB,QAAQ,WAC1Bd,EAAQL,SAMmBuB,CAAU1B"}